Input to the Viscosity (VSC) Package is read from the file that has type ``VSC6'' in the Name File.  If the VSC Package is active within a groundwater flow model, then the model will account for variations in viscosity on groundwater flow.  Viscosity may be calculated as a function of one or more groundwater solute transport (GWT) species using an approach described in the Supplemental Technical Information document distributed with MODFLOW 6 (Chapter 8).  Only one VSC Package may be active within a GWF model. The VSC Package may be coupled with one or more GWT Models so that the fluid viscosity is updated dynamically with one or more simulated concentration fields.

The VSC Package calculates fluid viscosity using the following equation of state from \cite{langevin2008seawat}:

\begin{equation}
\label{eqn:visclinear}
\mu = VISCREF + \sum_{i=1}^{NVISCSPECIES} DVISCDC_i \left ( CONCENTRATION_i - CVISCREF_i \right )
\end{equation}

\noindent where $\mu$ is the calculated viscosity, $VISCREF$ is the viscosity of a reference fluid, typically taken to be freshwater at a temperature of 20 $^{\circ}$C, $NVISCSPECIES$ is the number of chemical species that contribute to the viscosity calculation, $DVISCDC_i$ is the parameter that describes how viscosity changes linearly as a function of concentration for chemical species $i$ (i.e. the slope of a line that relates viscosity to concentration), $CONCENTRATION_i$ is the concentration of species $i$ and will commonly be set equal to the concentration calculated by one or more GWT models, and $CVISCREF_i$ is the reference concentration for species $i$ corresponding to when the viscosity of the reference fluid is equal to $VISCREF$ (typically set to zero when accounting for the effects of dissolved solute on viscosity).

In many cases, fluid viscosity is generally considered to be more sensitive to variations in temperature than to variations in concentration.  When simulating temperature as a species \citep{zheng2010supplemental}, the simulated fluid viscosity may vary linearly with changes in temperature using equation~\ref{eqn:visclinear}.  For example, $DVISCDC_i$, the paramter that describes how viscosity changes linearly as a function of concentration, can effectively serve as a surrogate for $DVISCDT_i$ (note that $DC_i$ changed to $DT_i$), a term representing changes in viscosity as a function of temperature.  Analogously, $CONCENTRATION_i$ and $CVISCREF_i$ serve as surrogates for $TEMPERATURE_i$ and $TVISCREF_i$, representing the dynamically simulated (or specified at the boundary) temperature and reference temperature for species $i$, respectively.  

In addition to supporting a linear relationship between viscosity and temperature, the VSC package also supports a nonlinear relationship as well.  For the nonlinear case, the VSC package may be directed to solve the following equation of state:

\begin{equation}
\label{eqn:viscnonlinear}
\mu = \mu_T(T) + \sum_{i=1}^{NVISCSPECIES} DVISCDC_i \left ( CONCENTRATION_i - CVISCREF_i \right )
\end{equation}

\noindent where the second term on the right-hand side of the equation adjusts the viscosity based on one or more solute concentrations and $\mu_T(T)$ calculates the viscosity adjustment based on the simulated temperature using,

\begin{equation}
\label{eqn:munonlinear}
\mu_T(T) = CVISCREF_i \cdot A_2^{\left [ \frac {-A_3 \left ( CONCENTRATION_i - CVISCREF_i \right ) } {\left ( CONCENTRATION_i + A_4 \right ) \left ( CVISCREF_i + A_4 \right )} \right ]}
\end{equation}

\noindent where the coefficients $A_2$, $A_3$, and $A_4$ are specified by the user.  Values for $A_2$, $A_3$, and $A_4$ are commonly 10, 248.7, and 133.15, respectively  \citep{langevin2008seawat, Voss1984sutra}.
 
\subsubsection{Stress Packages}
For head-dependent stress packages, the VSC Package may require fluid viscosity and elevation for each head-dependent boundary so that the model can use the appropriate viscosity to calculate flow between the boundary and the aquifer.  By default, the boundary elevation is set equal to the cell elevation.  For water-table conditions, the cell elevation is calculated as bottom elevation plus half of saturation multiplied by the cell thickness.  If desired, the user can more precisely locate the boundary elevation by specifying an auxiliary variable with the name ``ELEVATION''.  The program will use the values in this column as the boundary elevation.  A situation where this may be required is for river or general-head boundaries that are conceptualized as being on top of a model cell.  In those cases, an ELEVATION column should be specified and the values set to the top of the cell or some other appropriate elevation that corresponds to where the boundary stage applies.

By default, the boundary viscosity is set equal to VISCREF, which, for freshwater, is typically set equal to 1.0. However, there are two additional options for setting the viscosity of a boundary package.  The first is to assign an auxiliary variable with the name ``VISCOSITY''.  If an auxiliary variable named ``VISCOSITY'' is detected, then it will be assigned as the viscosity of the fluid entering from the boundary.  Alternatively, a viscosity value can be calculated for each boundary using the viscosity equation of state (described above) and one or more concentrations provided as auxiliary variables.  In this case, the user must assign one auxiliary variable for each AUXSPECIESNAME listed in the PACKAGEDATA block below.  Thus, there must be NVISCSPECIES auxiliary variables, each with the identical name as those specified in PACKAGEDATA.  The VSC Package will calculate the viscosity for each boundary using these concentrations and the values specified for VISCREF, DVISCDC, and CVISCREF.  If the boundary package contains an auxiliary variable named VISCOSITY and also contains AUXSPECIESNAME auxiliary variables, then the specified - not the internally calculated - boundary viscosity value will be assigned to the one in the VISCOSITY auxiliary variable.

A GWT Model can be used to calculate concentration of features associated with one of the advanced stress packages (LAK, SFR, MAW, and UZF) if corresponding advanced transport packages are specified (LKT, SFT, MWT, and UZT).  The advanced stress packages have an input option called FLOW\_PACKAGE\_AUXILIARY\_NAME.  When activated, this option will result in the simulated concentration for a lake or other feature being copied from the advanced transport package into the auxiliary variable for the corresponding GWF stress package.  This means that the viscosity for a lake or stream, for example, can be dynamically updated during the simulation using concentrations from advanced transport packages that are fed into auxiliary variables in the advanced stress packages, and ultimately used by the VSC Package to calculate a fluid viscosity using the equation of state.  This concept also applies when multiple GWT Models are used simultaneously to simulate multiple species.  In this case, multiple auxiliary variables are required for an advanced stress package, with each one representing a concentration from a different GWT Model.  


\begin{longtable}{p{3cm} p{12cm}}
\caption{Description of viscosity terms for stress packages}
\tabularnewline
\hline
\hline
\textbf{Stress Package} & \textbf{Note} \\
\hline
\endhead
\hline
\endfoot
GHB & ELEVATION can be specified as an auxiliary variable.  A VISCOSITY auxiliary variable or one or more auxiliary variables for calculating viscosity in the equation of state can be specified \\
RIV & ELEVATION can be specified as an auxiliary variable.  A VISCOSITY auxiliary variable or one or more auxiliary variables for calculating viscosity in the equation of state can be specified \\
DRN & The drain formulation assumes that the drain boundary contains water of the same viscosity as the discharging water; auxiliary variables have no effect on the drain calculation  \\
LAK & Elevation for each lake-aquifer connection is determined based on lake bottom and adjacent cell elevations. A VISCOSITY auxiliary variable or one or more auxiliary variables for calculating viscosity in the equation of state can be specified \\
SFR & Elevation for each sfr-aquifer connection is determined based on stream bottom and adjacent cell elevations. A VISCOSITY auxiliary variable or one or more auxiliary variables for calculating viscosity in the equation of state can be specified \\
MAW & Elevation for each maw-aquifer connection is determined based on cell elevation. A VISCOSITY auxiliary variable or one or more auxiliary variables for calculating viscosity in the equation of state can be specified \\
UZF & Pending ... \\
\end{longtable}

\vspace{5mm}
\subsubsection{Structure of Blocks}

\vspace{5mm}
\noindent \textit{FOR EACH SIMULATION}
\lstinputlisting[style=blockdefinition]{./mf6ivar/tex/gwf-vsc-options.dat}
\lstinputlisting[style=blockdefinition]{./mf6ivar/tex/gwf-vsc-dimensions.dat}
\lstinputlisting[style=blockdefinition]{./mf6ivar/tex/gwf-vsc-packagedata.dat}

\vspace{5mm}
\subsubsection{Explanation of Variables}
\begin{description}
\input{./mf6ivar/tex/gwf-vsc-desc.tex}
\end{description}

\vspace{5mm}
\subsubsection{Example Input File}
\lstinputlisting[style=inputfile]{./mf6ivar/examples/gwf-vsc-example.dat}
