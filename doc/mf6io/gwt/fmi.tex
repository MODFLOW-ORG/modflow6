Flow Model Interface (FMI) Package information is read from the file that is specified by ``FMI6'' as the file type.  The FMI Package is optional, but if provided, only one FMI Package can be specified for a GWT model.

For most simulations, the GWT Model needs groundwater flows for every cell in the model grid, for all boundary conditions, and for other terms, such as the flow of water in or out of storage.  The FMI Package is the interface between the GWT Model and simulated groundwater flows coming from a corresponding GWF Model that is running concurrently within the simulation or from a binary budget file that was created from a previous GWF model run.  The following are the different FMI simulation cases:

\begin{itemize}

\item Flows are provided by a corresponding GWF Model running in the same simulation---in this case, all groundwater flows are calculated by the corresponding GWF Model and provided through FMI to the transport model.  This is a common use case in which the user wants to run the flow and transport models as part of a single simulation.  The GWF and GWT models must be part of a GWF-GWT Exchange that is listed in mfsim.nam.

\item There is no groundwater flow and the user is interested only in the effects of diffusion, sorption, and decay or production---in this case, FMI should not be provided in the GWT name file and the GWT model should not be listed in any GWF-GWT Exchanges in mfsim.nam.  In this case, all groundwater flows are assumed to be zero and cells are assumed to be fully saturated.  The SSM Package should not be activated in this case, because there can be no sources or sinks of water.  This type of model simulation without an FMI Package is included as an option to represent diffusion, sorption, and decay or growth in the absence of flow groundwater.

\item Flows are provided from a previous GWF model simulation---in this case FMI should be provided in the GWT name file and the head and budget files should be listed in the FMI options block.  In this case, FMI reads the simulated head and flows from these files and makes them available to the transport model.  There are some additional considerations when the heads and flows are provided from binary files.

\begin{itemize}
\item The binary budget file must contain the simulated flows for all of the packages that were included in the GWF model run.  Saving of flows can be activated for all packages by specifying ``SAVE\_FLOWS'' as an option in the GWF name file.  The GWF Output Control Package must also have ``SAVE BUGET ALL'' specified.  The easiest way to ensure that all flows and heads are saved is to use the following simple form of a GWF Output Control file:

\begin{verbatim}
BEGIN OPTIONS
  HEAD FILEOUT mymodel.hds
  BUDGET FILEOUT mymodel.bud
END OPTIONS

BEGIN PERIOD 1
  SAVE HEAD ALL
  SAVE BUDGET ALL
END PERIOD
\end{verbatim}

\item The binary budget file must have the same number of budget terms listed for each time step.  This will always be the case when the binary budget file is created by \mfdot
\item The binary heads file must have heads saved for all layers in the model.  This will always be the case when the binary head file is created by \mfdot  This was not always the case as previous MODFLOW versions allowed different save options for each layer.
\item If the binary budget and head files have more than one time step for a single stress period, then the budget and head information must be contained within the binary file for every time step in the simulation stress period.
\item The binary budget and head files must correspond in terms of information stored for each time step and stress period.
\item If the binary budget and head files have information provided for only the first time step of each stress period, then this information will be used for all time steps in the GWT model run for that stress period.  This makes it possible to provide flows, for example, from a steady state GWF stress period and have those flows used for all steps in the GWT simulation.  Note that this cannot be done when the GWF and GWT models are run in the same simulation, because in that case, both models are solved for each time step in the stress period, as listed in the TDIS Package.
\end{itemize}

\end{itemize}

\vspace{5mm}
\subsubsection{Structure of Blocks}
\lstinputlisting[style=blockdefinition]{./mf6ivar/tex/gwt-fmi-options.dat}

\vspace{5mm}
\subsubsection{Explanation of Variables}
\begin{description}
\input{./mf6ivar/tex/gwt-fmi-desc.tex}
\end{description}

\vspace{5mm}
\subsubsection{Example Input File}
\lstinputlisting[style=inputfile]{./mf6ivar/examples/gwt-fmi-example.dat}

